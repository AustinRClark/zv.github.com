---
layout: page
title: A Review of ZSH Completion
excerpt: Walking through ZSH completion, step by step.
tags: 
  - zsh
  - completion
category: note
---


<section id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1"></h2>
<div class="outline-text-2" id="text-orgheadline1">
<p display="none">
ZSH completion scripts rarely capture programmers interest for their elegance; I
myself have called the system /"excruciatingly awful"/ therefore despite my
brilliant jabs and clever anecdotes, I doubt they could capture your interest in
this somewhat spiritless topic for long.
</p>

<p>
In consideration of this, I have organized these sections in order of greatest
importance to the topic (excepting this first section), so the devoted reader
can stop reading this article at whatever point you lose interest.
</p>

<p>
In 2007, ZSH started to experience some real growth. Increasingly rabid advocacy
had finally stirred many into dissatisfaction with the inflexible completion
system of other shells (c.f bash); one of these new users was me.
</p>

<p>
Initially appealing was ZSH's lengthy, albeit comprehensive documentation;
infamous for it's enumeration of digressions, anecdotes and man page '<i>end
notes</i>' (occassionally having footnotes themselves), in a medium distinctly
lacking both. This incidentally provides a unique distinction for a manual page
of supporting a wide range of interpretations and the potential to generate
critical theory literature for years, which I am sure is on it's way to becoming
a robust scholarly enterprise.
</p>

<p>
ZSH's creator, Peter Stephenson is largely responsible for this possibly great
documentation. Like most of us who set out to change the world of programming,
he found it difficult to manage his own programs - ZSH and it's completion
system became more sophisticated, the system and it's related documentation
began to become one of the largest emitters of user question marks on the
mailing list.
</p>

<p>
In ernest however, it is the single best compendium of information about ZSH
completion. Although <i>structural</i> questions are rarely answered, as a reference,
 it is unmatched.
</p>

<p>
I will not be addressing any of the following:
</p>
<ul class="org-ul">
<li>How to set up completion and associated zstyles</li>
<li>Adding completion</li>
</ul>
</div>
</section>

<section id="outline-container-orgheadline2" class="outline-2">
<h2 id="orgheadline2">The structure of standard argument completion with <code>_arguments</code></h2>
<div class="outline-text-2" id="text-orgheadline2">
<p>
At some point in the distant past, it was agreed that the way completion scripts
should be done is as follows:
</p>

<ol class="org-ol">
<li>An entry point will processes the command line string which is executed upon <span class="verbatim">&lt;TAB&gt;</span>, <b>removing the head of the command</b> (to ease processing, more on this later).</li>
<li>A function for each subcommand, typically wrapping <i>_arguments</i></li>
<li>One function for each type of object, referred to as a <i>tag</i> in ZSH nomenclature.</li>
<li>A function to handle special values, files, sockets, fifos</li>
</ol>

<p>
Not to belabour the points above, but removing the head of the command to is the
easiest way to build <i>context</i> - everything that the shell knows about the
meaning of the command line and the significance of the cursor position.
</p>

<p>
Our context, will start out very generic e.g "<i>The user is requesting completion
of grep</i>, and becomes more specific as more is learned, e.g "the current word
is in a position that is usually a command name" or "the current word might be a
variable name" and so
on.
Therefore, changing the currently understood value of the context "
Therefore the context will vary during the same call to the completion system.
</p>

<p>
In general, this is how most completion functions are structured. So, while painful,
understanding the next few paragraphs describing <i>_arguments</i> (with judicious
application of copy-paste) will get you through the majority of completion
scripts that you will need to write in ZSH and should be fully understood. 
</p>

<p>
<span class="verbatim">zshcompsys(1)</span> itself provides a lengthy but occassionally ambiguous treatment
of the function, I'll try to clear up some practical details here.
</p>
</div>

<div id="outline-container-orgheadline3" class="outline-3">
<h3 id="orgheadline3">The structure of <code>_arguments</code></h3>
<div class="outline-text-3" id="text-orgheadline3">
<p>
The function <i>_arguments</i> has been described as having `the syntax from hell', but
with the arguments already laid out in front of you it doesn't look so bad. The
are three types of argument: options to _arguments itself, arguments saying how
to handle options to the command (i.e. `p4 diff'), and arguments saying how to
handle normal arguments to the command.
</p>



<figure>
<p><object type="image/svg+xml" data="../../images/zsh-command-structure.svg" >
Sorry, your browser does not support SVG.</object>
</p>
</figure>

<p>
The following is an excerpt from the <i>p4 diff</i> completion function (in turn
excerpted from the manual) and covers some important fundamentals of argument parsing.
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #859900; font-weight: bold;">function</span>  <span style="color: #268bd2;">_perforce_cmd_diff</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
      _arguments -s : <span style="color: #2aa198;">\ </span>
          <span style="color: #2aa198;">'-f[diff every file]'</span> <span style="color: #2aa198;">\ </span>
          <span style="color: #2aa198;">'-t[include non-text files]'</span> <span style="color: #2aa198;">\ </span>
          <span style="color: #2aa198;">'(-sd -se -sr)-sa[opened files, different or missing]'</span> <span style="color: #2aa198;">\ </span>
          <span style="color: #2aa198;">'(-sa -se -sr)-sd[unopened files, missing]'</span> <span style="color: #2aa198;">\ </span>
          <span style="color: #2aa198;">'(-sa -sd -sr)-se[unopened files, different]'</span> <span style="color: #2aa198;">\ </span>
          <span style="color: #2aa198;">'(-sa -sd -se)-sr[opened files, same as depot]'</span> <span style="color: #2aa198;">\ </span>
          <span style="color: #2aa198;">'-d-[select diff option]:diff option:'</span> <span style="color: #2aa198;">\ </span>
  <span style="color: #2aa198;">'((b\:ignore\ blanks c\:context n\:RCS s\:summary'</span> <span style="color: #2aa198;">\ </span>
    <span style="color: #2aa198;">'u\:unified w\:ignore\ all\ whitespace))'</span> <span style="color: #2aa198;">\ </span>
          <span style="color: #2aa198;">"*::file:_perforce_files"</span>
  <span style="color: #2aa198;">}</span>
</pre>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-4">
<h4 id="orgheadline4">Flags</h4>
<div class="outline-text-4" id="text-orgheadline4">
<p>
The excerpt above only has one flag, and it's the most meaningful flag as well,
but I won't waste an opportunity to briefly cover some other very handy flags:
</p>

<p>
<span class="verbatim">-s</span> conveys that single-letter options are allowed, i.e. they can be combined
as in `-ft', although this doesn't prevent you from acceping multiple word
options either. <code>-w</code> is related; in combination with <code>-s</code> it means that the
options can stack even if one of them itself takes an argument.
</p>

<p>
For example, <code>tar -cf $FILE</code> could be processed in this way, as the option after
<code>-f</code> indicates the file we'd be processing (further options AFTER <code>-f</code> would be
valid as well)
</p>

<p>
<code>-S</code> is completely unrelated, it indicates that the completion function
shouldn't complete options after <span class="verbatim">--</span>, which is a common UNIX 'pattern' to
indicate options have ended.
</p>
</div>
</div>

<div id="outline-container-orgheadline5" class="outline-4">
<h4 id="orgheadline5">The optspec</h4>
<div class="outline-text-4" id="text-orgheadline5">
<p>
The long strings of option specification that follows the flags to <i>_arguments</i>
and a colon are known known as /optspec/s or option specification.
</p>
</div>

<ul class="org-ul"><li><a id="orgheadline6"></a>Option Naming or <i>optnames</i><br ><div class="outline-text-5" id="text-orgheadline6">
<p>
<i>_arguments</i> broadly supports 7 different option specification varieties, all of
which can be directly followed by a bracketed explanation string.
</p>
</div>

<ul class="org-ul"><li><a id="orgheadline7"></a>-optname , +optname &amp; +-optname<br ><div class="outline-text-6" id="text-orgheadline7">
<p>
The simplest form, indicating that +,- or +/-optname are valid options. the
first would match <code>foo -optname</code>, the next <code>foo \+optname</code>. The last matches
both.
</p>
</div></li>
<li><a id="orgheadline8"></a>-optname-, -optname+ or -optname=, -optname=-<br ><div class="outline-text-6" id="text-orgheadline8">
<p>
Identical to the above, but accepting arguments.
The former accepting command strings without spacing, e.g <code>foo -optnamearg</code>
the latter with spacing: <code>foo -optname arg</code>. An equals sign is identical in
functionality but being delimited by an equals sign, e.g: <code>foo -optname=arg</code>
</p>

<p>
All colons are escaped.
</p>
</div></li></ul></li></ul>
</div>

<div id="outline-container-orgheadline9" class="outline-4">
<h4 id="orgheadline9">Option Arguments (optarg)</h4>
</div>
</div>
</section>


<section id="outline-container-orgheadline14" class="outline-2">
<h2 id="orgheadline14">Utility Functions</h2>
<div class="outline-text-2" id="text-orgheadline14">
</div><div id="outline-container-orgheadline10" class="outline-3">
<h3 id="orgheadline10">Creating a dummy first argument</h3>
<div class="outline-text-3" id="text-orgheadline10">
<p>
The following is an extract of the iproute2 argument handling in <a href="https://github.com/zsh-users/zsh/blob/master/Completion/Unix/Command/_ip"><span class="verbatim">_ip</span></a>
</p>

<div class="org-src-container">

<pre class="src src-sh"><span style="color: #839496; font-weight: bold;">local</span> args
<span style="color: #268bd2;">args</span>=<span style="color: #2aa198;">(</span>
  <span style="color: #586e75;"># </span><span style="color: #586e75;">Command word</span>
  /$<span style="color: #2aa198;">'[^\0]#\0'</span>/
  <span style="color: #2aa198;">'l*ink:configure network device:$link_cmds'</span> <span style="color: #b58900; font-weight: bold;">\</span>
  <span style="color: #2aa198;">'addrlabel:manage addrlabel:$addrlabel_cmds'</span> <span style="color: #b58900; font-weight: bold;">\</span>
  <span style="color: #2aa198;">'a*ddr:manage protocol address:$addr_cmds'</span> <span style="color: #b58900; font-weight: bold;">\</span>
<span style="color: #2aa198;">)</span>
_regex_arguments _command
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline11" class="outline-3">
<h3 id="orgheadline11"><code>_pick_variant</code> to add options depending upon the version of a program.</h3>
<div class="outline-text-3" id="text-orgheadline11">
<div class="org-src-container">

<pre class="src src-shell-script"><span style="color: #839496; font-weight: bold;">local</span> arguments
<span style="color: #586e75;"># </span><span style="color: #586e75;">We supply a regex to _pick_variant, in this case checking gor the string `gnu`</span>
<span style="color: #859900; font-weight: bold;">if</span> <span style="color: #b58900; font-weight: bold;">!</span> _pick_variant <span style="color: #268bd2;">gnu</span>=gnu unix --help; <span style="color: #859900; font-weight: bold;">then</span>
  <span style="color: #268bd2;">arguments</span>=<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'-g[This flag only works on gnu distributions of this binary]'</span><span style="color: #2aa198;">)</span>
<span style="color: #859900; font-weight: bold;">else</span>
  <span style="color: #268bd2;">arguments</span>=<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'-a[Otherwise this flag is available]'</span><span style="color: #2aa198;">)</span>
<span style="color: #859900; font-weight: bold;">fi</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline12" class="outline-3">
<h3 id="orgheadline12">Match an ambiguous clause with <code>_guard</code></h3>
<div class="outline-text-3" id="text-orgheadline12">
<p>
The <code>_guard</code> can break between two tags, dependent upon the regex; if this
doesn't seem extraordinarily useful to you, you're not alone &#x2013; In the body of
existing ZSH completion scripts, <code>_guard</code> is typically used an the <i>action</i> for
the specification pased into <code>_arguments</code> and similar functions.
</p>

<p>
The <span class="verbatim">zshcompsys</span> manpage itself describes behavior reminiscent of the completion
behavior of <code>fc(1)</code>
<span class="verbatim">_guard</span>
</p>
<blockquote>
<p>
As an example, consider a command taking the options -n and -none,
where -n must be followed by a numeric value in the same word. 
</p>

<p>
zshcompsys(4)
</p>
</blockquote>

<p>
In the interest of <del>laziness</del> expedience, I will quote <code>_fc</code> here.
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #2aa198;">[</span><span style="color: #b58900;">[</span> -n $<span style="color: #268bd2;">state</span> <span style="color: #b58900;">]</span><span style="color: #2aa198;">]</span>; <span style="color: #859900; font-weight: bold;">then</span>
  zstyle -s <span style="color: #2aa198;">":completion:${curcontext}:"</span> list-separator sep || <span style="color: #268bd2;">sep</span>=--
  <span style="color: #859900; font-weight: bold;">if</span> <span style="color: #2aa198;">[</span><span style="color: #b58900;">[</span> -z $<span style="color: #268bd2;">{</span><span style="color: #268bd2;">line</span>:#*=*<span style="color: #268bd2;">}</span> <span style="color: #b58900;">]</span><span style="color: #2aa198;">]</span> &amp;&amp; compset -P <span style="color: #2aa198;">'*='</span>; <span style="color: #859900; font-weight: bold;">then</span>
    _message -e replacements <span style="color: #2aa198;">'replacement'</span>
  <span style="color: #859900; font-weight: bold;">elif</span> <span style="color: #2aa198;">[</span><span style="color: #b58900;">[</span> -prefix <span style="color: #268bd2;">[</span><span style="color: #268bd2; font-weight: bold;">0-9</span><span style="color: #268bd2;">]</span> <span style="color: #b58900;">]</span><span style="color: #2aa198;">]</span>; <span style="color: #859900; font-weight: bold;">then</span>
    <span style="color: #268bd2;">events</span>=<span style="color: #2aa198;">(</span> $<span style="color: #b58900;">{</span><span style="color: #268bd2;">(</span><span style="color: #268bd2; font-weight: bold;">0</span><span style="color: #268bd2;">)</span><span style="color: #2aa198;">"$(printf "%-${#HISTNO}.${#HISTNO}s $sep %s\0" "${(kv)history[@]}")"</span><span style="color: #b58900;">}</span> <span style="color: #2aa198;">)</span>
    _wanted -2V events expl <span style="color: #2aa198;">"$state_descr"</span> compadd -M <span style="color: #2aa198;">"B:0="</span> -ld events - <span style="color: #b58900; font-weight: bold;">\</span>
        <span style="color: #2aa198;">"${events[@]%% *}"</span>
  <span style="color: #859900; font-weight: bold;">elif</span> <span style="color: #2aa198;">[</span><span style="color: #b58900;">[</span> -prefix - <span style="color: #b58900;">]</span><span style="color: #2aa198;">]</span>; <span style="color: #859900; font-weight: bold;">then</span>
    <span style="color: #859900; font-weight: bold;">for</span> num cmd<span style="color: #859900; font-weight: bold;"> in</span> <span style="color: #2aa198;">"${(kv@)history}"</span>; <span style="color: #859900; font-weight: bold;">do</span>
      <span style="color: #2aa198;">(</span><span style="color: #b58900;">(</span> <span style="color: #268bd2;">num</span>=num - HISTNO <span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>
      <span style="color: #268bd2;">events</span>+=<span style="color: #2aa198;">(</span> <span style="color: #2aa198;">"${(r.1+$#HISTNO.)num} $sep $cmd"</span> <span style="color: #2aa198;">)</span>
    <span style="color: #859900; font-weight: bold;">done</span>
    _wanted -2V events expl <span style="color: #2aa198;">"$state_descr"</span> compadd -ld events - <span style="color: #b58900; font-weight: bold;">\</span>
        <span style="color: #2aa198;">"${events[@]%% *}"</span>
  <span style="color: #859900; font-weight: bold;">else</span>
    _wanted events expl <span style="color: #2aa198;">"$state_descr"</span> compadd -S <span style="color: #2aa198;">''</span> - <span style="color: #b58900; font-weight: bold;">\</span>
        $<span style="color: #2aa198;">{</span><span style="color: #268bd2;">$</span><span style="color: #b58900;">{</span><span style="color: #839496; font-weight: bold;">history</span>%%<span style="color: #268bd2;">[</span>=<span style="color: #6c71c4;">[</span>:IFS:<span style="color: #6c71c4;">]</span><span style="color: #268bd2;">]</span>*<span style="color: #b58900;">}</span>:#<span style="color: #b58900;">[</span><span style="color: #268bd2; font-weight: bold;">0-9-</span><span style="color: #b58900;">]</span>*<span style="color: #2aa198;">}</span> || _guard <span style="color: #2aa198;">"[0-9]#"</span> event
  <span style="color: #859900; font-weight: bold;">fi</span>
<span style="color: #859900; font-weight: bold;">fi</span> &amp;&amp; <span style="color: #268bd2;">ret</span>=<span style="color: #268bd2; font-weight: bold;">0</span>
</pre>
</div>
</div>

<div id="outline-container-orgheadline13" class="outline-4">
<h4 id="orgheadline13">Example</h4>
<div class="outline-text-4" id="text-orgheadline13">
<p>
<a href="file:///usr/share/zsh/5.1.1/functions/_fc">file:///usr/share/zsh/5.1.1/functions/_fc</a>
</p>
</div>
</div>
</div>
</section>


<section id="outline-container-orgheadline15" class="outline-2">
<h2 id="orgheadline15">Examples</h2>
<div class="outline-text-2" id="text-orgheadline15">
<p>
A statement about these examples should be made here
</p>
</div>

<div id="outline-container-orgheadline16" class="outline-3">
<h3 id="orgheadline16">Delimited values with final option</h3>
<div class="outline-text-3" id="text-orgheadline16">
<p>
A common scenario that occurs in commands such as <i>libcap</i>'s capability
manipulation toolchain, <i>bintools</i> and <i>coreutils</i> is the requirement to
complete a list of arbitrary keywords, each with a unix-style (equal sign)
option after each one.
</p>

<p>
An example of such a command is exemplified by <code>setcap</code>
</p>

<section class="terminal-example">
<pre class="terminal-example">
<samp class="terminal-example">
% setcap cap_sys_rawio,cap_sys_pacct=<div class="blinking-cursor">█</div>
<span class="yellow"> -- operator -- </span>
e  -- effective
i  -- inheritable
p  -- permitted
</samp>
</pre>
</section>

<p>
You might initially look at the <code>chmod</code> completion, and this would get you far,
however the completion script itself is quite long. The core of the unix options
completion lies in the following.
</p>

<div class="org-src-container">

<pre class="src src-sh"><span style="color: #268bd2;">list_terminator</span>=<span style="color: #2aa198;">'*[=]'</span> <span style="color: #586e75;"># </span><span style="color: #586e75;">Corresponds to `=` </span>
<span style="color: #268bd2;">delimiter</span>=<span style="color: #2aa198;">','</span> <span style="color: #586e75;"># </span><span style="color: #586e75;">The character that delimits the list</span>
<span style="color: #268bd2;">options</span>=<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"e:effective"</span>, <span style="color: #2aa198;">"i:inheritable"</span>, <span style="color: #2aa198;">"p:permitted"</span><span style="color: #2aa198;">)</span> <span style="color: #586e75;"># </span><span style="color: #586e75;">Valid options</span>
<span style="color: #859900; font-weight: bold;">case</span> $<span style="color: #268bd2;">state</span><span style="color: #859900; font-weight: bold;"> in</span>
  <span style="color: #586e75;"># </span><span style="color: #586e75;">compset -P checks if we've reached a user entering a $list_terminator</span>
  <span style="color: #859900; font-weight: bold;">if</span> compset -P $<span style="color: #268bd2;">list_terminator</span>; <span style="color: #859900; font-weight: bold;">then</span>
    _describe -t options <span style="color: #2aa198;">"options"</span> options
  <span style="color: #859900; font-weight: bold;">else</span> <span style="color: #586e75;"># </span><span style="color: #586e75;">Otherwise complete from these list of items.</span>
    _values -s $<span style="color: #268bd2;">delimiter</span> items 
      <span style="color: #2aa198;">'foo[Description of foo]'</span> <span style="color: #b58900; font-weight: bold;">\</span>
      <span style="color: #2aa198;">'bar[Description of bar]'</span>
  <span style="color: #859900; font-weight: bold;">fi</span>
  ;;
<span style="color: #859900; font-weight: bold;">esac</span>
</pre>
</div>
</div>

<div id="outline-container-orgheadline17" class="outline-4">
<h4 id="orgheadline17">Scripts</h4>
<div class="outline-text-4" id="text-orgheadline17">
<p>
<a href="https://github.com/zv/zsh-completions/blob/9ca66cf7d4af9ecfe5c3d91e7b56f24408b7f312/src/_setcap">- setcap</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline18" class="outline-3">
<h3 id="orgheadline18">Operating system specific flags with <code>$OSTYPE</code></h3>
<div class="outline-text-3" id="text-orgheadline18">
<div class="org-src-container">

<pre class="src src-shell-script"><span style="color: #839496; font-weight: bold;">local</span> arguments
<span style="color: #268bd2;">arguments</span>=<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'-b[Base argument]'</span><span style="color: #2aa198;">)</span>
<span style="color: #586e75;"># </span><span style="color: #586e75;">We might add additional arguments based on the operating system</span>
<span style="color: #859900; font-weight: bold;">if</span> <span style="color: #2aa198;">[</span><span style="color: #b58900;">[</span> <span style="color: #2aa198;">"$OSTYPE"</span> = <span style="color: #268bd2;">(</span>freebsd*|darwin*<span style="color: #268bd2;">)</span> <span style="color: #b58900;">]</span><span style="color: #2aa198;">]</span>; <span style="color: #859900; font-weight: bold;">then</span>
  <span style="color: #268bd2;">arguments</span>+=<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'-m[OSX or FreeBSD Specific Flag]'</span><span style="color: #2aa198;">)</span>
<span style="color: #859900; font-weight: bold;">fi</span>
<span style="color: #859900; font-weight: bold;">if</span> <span style="color: #2aa198;">[</span><span style="color: #b58900;">[</span> $<span style="color: #268bd2;">OSTYPE</span> = solaris* <span style="color: #b58900;">]</span><span style="color: #2aa198;">]</span>; <span style="color: #859900; font-weight: bold;">then</span>
  <span style="color: #268bd2;">arguments</span>+=<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'-s[Solaris specific flag]'</span><span style="color: #2aa198;">)</span>
<span style="color: #859900; font-weight: bold;">fi</span>
<span style="color: #859900; font-weight: bold;">if</span> <span style="color: #2aa198;">[</span><span style="color: #b58900;">[</span> $<span style="color: #268bd2;">OSTYPE</span> = linux* <span style="color: #b58900;">]</span><span style="color: #2aa198;">]</span>; <span style="color: #859900; font-weight: bold;">then</span>
  <span style="color: #268bd2;">arguments</span>+=<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'-l[Linux specific flag]'</span><span style="color: #2aa198;">)</span>
<span style="color: #859900; font-weight: bold;">fi</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline19" class="outline-3">
<h3 id="orgheadline19">Sharing implementation details between different completions with <span class="verbatim">$SERVICE</span></h3>
<div class="outline-text-3" id="text-orgheadline19">
<p>
adfadf
</p>
</div>
</div>
</section>


<section id="outline-container-orgheadline20" class="outline-2">
<h2 id="orgheadline20">Style and Convention</h2>
<div class="outline-text-2" id="text-orgheadline20">
<p>
ZSH completion scripts are (fortunately) never given the opportunity to evolve
into the complex balls of mud that a 'real' programming environment affords;
consequently there is much less attention given to the stylistic debates that
are tied to other languages.
</p>

<p>
This said, there are a few, largely unwritten, rules and conventions that
are 
</p>
</div>

<div id="outline-container-orgheadline21" class="outline-3">
<h3 id="orgheadline21">Terminology</h3>
<div class="outline-text-3" id="text-orgheadline21">
<ul class="org-ul">
<li><span class="verbatim">spec</span> : Argument Specification</li>
<li><span class="verbatim">tag</span> : The 'varieties' of types of objects that are valid completions, e.x a command that takes a set of permissions OR a file as it's next argument.</li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline22" class="outline-3">
<h3 id="orgheadline22">Variables</h3>
<div class="outline-text-3" id="text-orgheadline22">
<ul class="org-ul">
<li><span class="verbatim">$state</span> - The canonical variable for processing which tag you are in.</li>
<li><span class="verbatim">$expl</span>  - An idiom for options normally given to compadd at some point, typically an array</li>
<li><span class="verbatim">$descr</span> - Argument description variables</li>
</ul>
</div>
</div>
</section>

<section id="outline-container-orgheadline23" class="outline-2">
<h2 id="orgheadline23">External Resources</h2>
<div class="outline-text-2" id="text-orgheadline23">
<ul class="org-ul">
<li><a href="http://zsh.sourceforge.net/Guide/zshguide06.html#l144">The ZSH User Guide: Completion</a></li>
<li><a href="https://twitter.com/dailyzshtip">Daily ZSH Tips</a></li>
</ul>
</div>
</section>
